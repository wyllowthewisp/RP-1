CONTRACT_TYPE
{
	name = GOCrewedServicing
	title = Telescope Crewed Servicing Mission
	// genericTitle = Large Space Telescope Crewed Servicing Mission

	group = GreatObservatories
	agent = Federation Aeronautique Internationale

	description = <b>Program: Great Observatories<br>Type: <color=green>Required</color></b><br><br>One of our space telescopes is in need of component repairs and upgrades to continue operating optimally. Either launch a new crewed spacecraft or dock the telescope to a space station to allow crew to service it.

	synopsis = Send a crew to dock with and service instrumentation on the designated craft

	completedMessage = Mission success! The upgraded instrumentation is already producing scientific data.

	// sortKey = 1503

	cancellable = true
	declinable = true
	autoAccept = false
	minExpiry = 0
	maxExpiry = 0
	maxCompletions = 1
	maxSimultaneous = 1
	deadline = 0

	targetBody = HomeWorld()

	prestige = Trivial       // 1.0x
	advanceFunds = 0
	rewardScience = 0
	rewardReputation = 250
	rewardFunds = 0
	failureReputation = 0 // was @rewardReputation
	failureFunds = 0

	// ************ REQUIREMENTS ************

  	REQUIREMENT
	{
		name = ProgramActive
		type = ProgramActive
		program = GreatObservatories
	}
 
	REQUIREMENT
	{
		name = CompleteContract
		type = CompleteContract
		contractType = GOLargeSpaceTelescope
	}
	

	// ************ DATA ************

	DATA
	{
		type = Vessel
		requiredValue = true
		targetVessel1 = LSTcraft // this is the craft that completed the Large Space Telescope contract
		hidden = true
 	}

	BEHAVIOUR
	{
		name = ServicingReset
		type = Expression
		
		CONTRACT_COMPLETED_SUCCESS
		{
			TelescopeLastServiced = LSTcraft
			FirstServicingTime = UniversalTime()
		}
	}

	// ************ PARAMETERS ************

	PARAMETER
	{
		name = vesselGroupTelescope
		type = VesselParameterGroup
		title = Control a space telescope with the required parameters
		notes = The space telescope must have a docking port and be in an orbit matching the one in the Large Space Telescope contract
		define = LSTcraftVPG
		disableOnStateChange = true

		PARAMETER
		{
			name = DockingPort
			type = PartValidation
			partModule = ModuleDockingNode
			minCount = 1
			title = Have at least 1 docking port
			hideChildren = true
		}

		PARAMETER
		{
			name = Has Telescope
			type = PartValidation
			disableOnStateChange = true
			
			VALIDATE
			{
				MODULE
				{
					name = Experiment
					experiment_id = RP0BasicSpaceTelescope2
				}
			}
			title = Craft must have an Improved Space Telescope
		}		

		PARAMETER
		{
			name = Orbit
			type = Orbit
			targetBody = HomeWorld()
			minPeA = 400000 // 400 km
			maxApA = 950000 // these are the Large Space Telescope contract orbital parameters
			maxEccentricity = 0.005
			disableOnStateChange = true
		}
	}
	
	
	PARAMETER
	{
		name = vesselGroupTelescopeServicer
		type = VesselParameterGroup
		title = Dock a spacecraft with a servicing crew to the target space telescope
		// genericTitle = Dock a spacecraft with a servicing crew to the space telescope

		PARAMETER
		{
			name = DockingPort
			type = PartValidation
			partModule = ModuleDockingNode
			minCount = 1
			title = Craft must have at least one docking port
			hideChildren = true
		}

		PARAMETER
		{
			name = Crewmembers
			type = HasCrew
			minCrew = 3
			crewOnly = true
			title = Bring a minimum crew of @minCrew
			hideChildren = true
		}

  		PARAMETER
		{
			name = HasResource
			type = HasResource
			resource = ResearchPayload
			minQuantity = 600 // WFPC2 + COSTAR was 571 kg
			title = Bring @minQuantity units of ResearchPayload as replacement instruments
		}

		PARAMETER
		{
			name = Rendezvous
			type = Rendezvous
			vessel = LSTcraftVPG
			distance = 100
			title = Rendezvous with the target space telescope
		}

  		PARAMETER
		{
			name = DockingSequence
			type = Sequence
			title = Dock with the target space telescope for 4 days to allow your engineers to service its instrumentation
			// genericTitle = Dock with the space telescope for 4 days to allow your engineers to service its instrumentation
   
			PARAMETER
			{
				name = Crewmembers
				type = HasCrew
				trait = Engineer
				minCrew = 2
				crewOnly = true
				title = Have at least 2 engineers on board to conduct servicing
				hideChildren = true
			}
			
			PARAMETER
			{
				name = Docking
				type = Docking
				vessel = LSTcraftVPG
				title = Dock with the target space telescope
				// genericTitle = Dock with the space telescope
			}

			PARAMETER
			{
				name = Duration
				type = Duration
				duration = 4d
				preWaitText = Remain docked for
				waitingText = Servicing instrumentation...
				completionText = Servicing: Complete
				disableOnStateChange = true
			}

		}

		PARAMETER
		{
			name = ReturnHome
			type = RP1ReturnHome
			title = Undock and return the crew home safely
			hideChildren = true
			completeInSequence = true
		}

		PARAMETER
		{
			name = RecoverKerbal
			type = RecoverKerbal
		}
   

	}

}
